!function(e){function d(e,d){var i=e.find(".dd-option-value[value= '"+d+"']").parents("li").prevAll().length;t(e,i)}function t(e,d,t){var i=e.data("ddslick"),s=e.find(".dd-selected"),o=s.siblings(".dd-selected-value"),l=(e.find(".dd-options"),s.siblings(".dd-pointer"),e.find(".dd-option").eq(d)),r=l.closest("li"),c=i.settings,p=i.settings.data[d];e.find(".dd-option").removeClass("dd-option-selected"),l.addClass("dd-option-selected"),i.selectedIndex=d,i.selectedItem=r,i.selectedData=p,s.html(c.showSelectedHTML?(p.cssSprite?'<span class="dd-selected-csssprite'+("right"==c.imagePosition?" dd-image-right "+p.cssSprite:" dd-image-left "+p.cssSprite)+'" />':"")+(p.imageSrc?'<img class="dd-selected-image'+("right"==c.imagePosition?" dd-image-right":"")+'" src="'+p.imageSrc+'" />':"")+(p.text?'<label class="dd-selected-text">'+p.text+"</label>":"")+(p.description?'<small class="dd-selected-description dd-desc'+(c.truncateDescription?" dd-selected-description-truncated":"")+'" >'+p.description+"</small>":""):p.text),o.val(p.value),i.original.val(p.value),e.data("ddslick",i),(void 0===t||t)&&n(e),a(e),"function"==typeof c.onSelected&&c.onSelected.call(this,i)}function i(d){if(!s(d)){var t=d.find(".dd-select"),i=t.siblings(".dd-options"),n=t.find(".dd-pointer"),o=i.is(":visible");e(".dd-click-off-close").not(i).slideUp(50),e(".dd-pointer").removeClass("dd-pointer-up"),t.removeClass("dd-open"),o?(i.slideUp("fast"),n.removeClass("dd-pointer-up"),t.removeClass("dd-open")):(t.addClass("dd-open"),i.slideDown("fast"),n.addClass("dd-pointer-up")),r(d)}}function n(e){e.find(".dd-select").removeClass("dd-open"),e.find(".dd-options").slideUp(50),e.find(".dd-pointer").removeClass("dd-pointer-up").removeClass("dd-pointer-up")}function s(e){return e.hasClass("dd-disabled")?!0:!1}function o(e){e.addClass("dd-disabled"),e.removeAttr("tabindex")}function l(e){e.hasClass("dd-disabled")&&(e.removeClass("dd-disabled"),e.attr("tabindex","0"))}function a(e){var d=e.find(".dd-select").css("height"),t=e.find(".dd-selected-description"),i=e.find(".dd-selected-image"),n=e.find(".dd-selected-csssprite");(t.length<=0&&i.length>0||t.length<=0&&n.length>0)&&e.find(".dd-selected-text").css("lineHeight",d)}function r(d){d.find(".dd-option").each(function(){var t=e(this),i=t.css("height"),n=t.find(".dd-option-description"),s=d.find(".dd-option-image"),o=d.find(".dd-selected-csssprite");(n.length<=0&&s.length>0||n.length<=0&&o.length>0)&&t.find(".dd-option-text").css("lineHeight",i)})}function c(e,d){var t=e.find(".dd-select").siblings(".dd-options"),s=e.data("ddslick"),o=d.keyCode||d.which;if(d.altKey&&o==h.downArrow)return i(e),!1;if(o==h.enter)return t.is(":visible")&&n(e),!1;if(o==h.leftArrow||o==h.upArrow){var l=s.selectedIndex-1;return l>=0&&p(e,t,l),!1}if(o==h.rightArrow||o==h.downArrow){var a=s.selectedIndex+1;return a<s.settings.data.length&&p(e,t,a),!1}return o==h.pageUp||o==h.home?(0!=s.selectedIndex&&p(e,t,0),!1):o==h.pageDown||o==h.end?(s.selectedIndex!=s.settings.data.length-1&&p(e,t,s.settings.data.length-1),!1):!0}function p(e,d,i){var n=d.is(":visible");n?t(e,i,!1):t(e,i)}e.fn.ddslick=function(d){return f[d]?f[d].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof d&&d?void e.error("Method "+d+" does not exists."):f.init.apply(this,arguments)};var f={},u={data:[],keepJSONItemsOnTop:!1,width:260,height:null,background:"#eee",selectText:"",defaultSelectedIndex:null,truncateDescription:!0,imagePosition:"left",showSelectedHTML:!0,clickOffToClose:!0,embedCSS:!0,onSelected:function(){},enableKeyboard:!0},h={enter:13,pageUp:33,pageDown:34,end:35,home:36,leftArrow:37,upArrow:38,rightArrow:39,downArrow:40},g='<ul class="dd-options"></ul>',m='<style id="css-ddslick" type="text/css">.dd-select{ border-radius:2px; border:solid 1px #ccc; position:relative; cursor:pointer;}.dd-desc { color:#aaa; display:block; overflow: hidden; font-weight:normal; line-height: 1.4em; }.dd-selected{ overflow:hidden; display:block; padding:10px; font-weight:bold;}.dd-disabled .dd-selected{ color: #8293a9;}.dd-pointer{ width:0; height:0; position:absolute; right:10px; top:50%; margin-top:-3px;}.dd-pointer-down{ border:solid 5px transparent; border-top:solid 5px #000; }.dd-disabled .dd-pointer-down{ transparent; border-top:solid 5px #8293a9; }.dd-pointer-up{border:solid 5px transparent !important; border-bottom:solid 5px #000 !important; margin-top:-8px;}.dd-options{ border:solid 1px #ccc; border-top:none; list-style:none; box-shadow:0px 1px 5px #ddd; display:none; position:absolute; z-index:2000; margin:0; padding:0;background:#fff; overflow:auto;}.dd-option{ padding:10px; display:block; border-bottom:solid 1px #ddd; overflow:hidden; text-decoration:none; color:#333; cursor:pointer;-webkit-transition: all 0.25s ease-in-out; -moz-transition: all 0.25s ease-in-out;-o-transition: all 0.25s ease-in-out;-ms-transition: all 0.25s ease-in-out; }.dd-options > li:last-child > .dd-option{ border-bottom:none;}.dd-option:hover{ background:#f3f3f3; color:#000;}.dd-selected-description-truncated { text-overflow: ellipsis; white-space:nowrap; }.dd-option-selected { background:#f6f6f6; }.dd-option-image, .dd-selected-image, .dd-selected-csssprite, dd-image-left{ vertical-align:middle; float:left; margin-right:5px; max-width:64px;}.dd-image-right { float:right; margin-right:15px; margin-left:5px;}.dd-container{ position:relative;}​ .dd-selected-text { font-weight:bold}​</style>';f.init=function(d){var n=e.extend({},u,d);return e("#css-ddslick").length<=0&&n.embedCSS&&e(m).appendTo("head"),this.each(function(){var n=e.extend({},u,d),s=e(this),l=s.data("ddslick");if(!l){{var a=[];n.data}s.find("option").each(function(){var d=e(this),t=d.data();a.push({text:e.trim(d.text()),value:d.val(),selected:d.is(":selected"),description:t.description,cssSprite:t.csssprite,imageSrc:t.imagesrc})}),n.keepJSONItemsOnTop?e.merge(n.data,a):n.data=e.merge(a,n.data);var r=s,p=e("<div>").attr("id",s.attr("id")+"-dd-placeholder").attr("tabindex","0");s.replaceWith(p),s=p,ddSelectHtml='<div class="dd-select"><input class="dd-selected-value" name="'+r.attr("name")+'" type="hidden" /><a class="dd-selected"></a><span class="dd-pointer dd-pointer-down"></span></div>',s.addClass("dd-container").append(ddSelectHtml).append(g),s.find("input.dd-selected-value").attr("id",e(r).attr("id")).attr("name",e(r).attr("name")),e(r).is(":disabled")&&o(s);var a=s.find(".dd-select"),f=s.find(".dd-options");f.css({width:n.width}),a.css({width:n.width,background:n.background}),s.css({width:n.width}),null!=n.height&&f.css({height:n.height,overflow:"auto"}),e.each(n.data,function(e,d){d.selected&&(n.defaultSelectedIndex=e),f.append('<li><a class="dd-option">'+(d.value?' <input class="dd-option-value" type="hidden" value="'+d.value+'" />':"")+(d.cssSprite?' <span class="dd-selected-csssprite'+("right"==n.imagePosition?" dd-image-right "+d.cssSprite:" dd-image-left "+d.cssSprite)+'" />':"")+(d.imageSrc?' <img class="dd-option-image'+("right"==n.imagePosition?" dd-image-right":"")+'" src="'+d.imageSrc+'" />':"")+(d.text?' <label class="dd-option-text">'+d.text+"</label>":"")+(d.description?' <small class="dd-option-description dd-desc">'+d.description+"</small>":"")+"</a></li>")});var h={settings:n,original:r,selectedIndex:-1,selectedItem:null,selectedData:null};if(s.data("ddslick",h),n.selectText.length>0&&null==n.defaultSelectedIndex)s.find(".dd-selected").html(n.selectText);else{var m=null!=n.defaultSelectedIndex&&n.defaultSelectedIndex>=0&&n.defaultSelectedIndex<n.data.length?n.defaultSelectedIndex:0;t(s,m)}s.find(".dd-select").on("click.ddslick",function(){i(s)}),s.find(".dd-option").on("click.ddslick",function(){t(s,e(this).closest("li").index())}),n.clickOffToClose&&(f.addClass("dd-click-off-close"),s.on("click.ddslick",function(e){e.stopPropagation()}),e("body").on("click",function(){e(".dd-open").removeClass("dd-open"),e(".dd-click-off-close").slideUp(50).siblings(".dd-select").find(".dd-pointer").removeClass("dd-pointer-up")})),n.enableKeyboard&&s.on("keydown.ddslick",function(e){return c(s,e)})}})},f.select=function(i){return this.each(function(){void 0!==i.index&&t(e(this),i.index),i.id&&d(e(this),i.id)})},f.open=function(){return this.each(function(){var d=e(this),t=d.data("ddslick");t&&i(d)})},f.close=function(){return this.each(function(){var d=e(this),t=d.data("ddslick");t&&n(d)})},f.destroy=function(){return this.each(function(){var d=e(this),t=d.data("ddslick");if(t){var i=t.original;d.removeData("ddslick").unbind(".ddslick").replaceWith(i)}})},f.disable=function(){return this.each(function(){var d=e(this);o(d)})},f.enable=function(){return this.each(function(){var d=e(this);l(d)})}}(jQuery);